<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Validate Your Idea from Real Users</title>

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
    rel="stylesheet"
  />

  <style>
    :root {
      --bg: #020617;
      --bg-card: rgba(15, 23, 42, 0.96);
      --bg-soft: rgba(15, 23, 42, 0.95);
      --accent: #6366f1;
      --accent-soft: rgba(99, 102, 241, 0.22);
      --accent-strong: #4ade80;
      --border-subtle: rgba(148, 163, 184, 0.35);
      --text-main: #e5e7eb;
      --text-muted: #9ca3af;
      --radius-xl: 22px;
      --shadow-soft: 0 22px 60px rgba(15, 23, 42, 0.9);
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      min-height: 100vh;
      padding: 40px 16px 48px;
      font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      color: var(--text-main);
      display: flex;
      justify-content: center;
      align-items: flex-start;
      background:
        radial-gradient(circle at 0% 0%, rgba(129, 140, 248, 0.18), transparent 55%),
        radial-gradient(circle at 100% 100%, rgba(56, 189, 248, 0.18), transparent 55%),
        radial-gradient(circle at 50% 120%, rgba(236, 72, 153, 0.22), transparent 65%),
        var(--bg);
      background-size: 200% 200%;
      animation: bgShift 22s ease-in-out infinite;
    }

    .shell {
      width: 100%;
      max-width: 960px;
    }

    /* HERO HEADER (outside card, centered) */
    .hero {
      text-align: center;
      margin-bottom: 22px;
    }

    .hero-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.14em;
      padding: 4px 10px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(148, 163, 184, 0.6);
      color: var(--text-muted);
      margin-bottom: 12px;
      backdrop-filter: blur(10px);
    }
    .hero-badge-dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: #22c55e;
      box-shadow: 0 0 0 4px rgba(34, 197, 94, 0.4);
      animation: pulseDot 2.4s ease-in-out infinite;
    }

    .hero-title {
      font-size: clamp(2.1rem, 4vw, 2.8rem);
      font-weight: 700;
      letter-spacing: -0.02em;
      margin-bottom: 6px;
      background: linear-gradient(120deg, #e5e7eb, #a5b4fc, #22c55e);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }

    .hero-subtitle {
      font-size: 14px;
      max-width: 540px;
      margin: 0 auto;
      color: var(--text-muted);
    }

    /* MAIN CARD */
    .app-card {
      margin: 0 auto;
      background: radial-gradient(circle at top, rgba(15, 23, 42, 0.98), #020617 58%);
      border-radius: 32px;
      padding: 22px 20px 20px;
      box-shadow: var(--shadow-soft);
      border: 1px solid rgba(148, 163, 184, 0.45);
      backdrop-filter: blur(22px);
      position: relative;
      overflow: hidden;
      max-width: 880px;
      animation: floatCard 5.2s ease-in-out infinite;
    }

    .app-card::before {
      content: "";
      position: absolute;
      inset: -40%;
      background:
        radial-gradient(circle at 0 0, rgba(59, 130, 246, 0.22), transparent 60%),
        radial-gradient(circle at 100% 100%, rgba(236, 72, 153, 0.22), transparent 60%);
      opacity: 0.7;
      mix-blend-mode: screen;
      pointer-events: none;
    }

    .app-inner {
      position: relative;
      z-index: 1;
    }

    /* FORM */
    .form-card {
      background: linear-gradient(135deg, rgba(15, 23, 42, 0.96), #020617);
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.4);
      padding: 8px 10px 8px 12px;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items: center;
      margin-bottom: 16px;
    }

    .form-label {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.18em;
      color: var(--text-muted);
      margin-bottom: 6px;
      text-align: center;
    }

    .url-input {
      flex: 1 1 260px;
      padding: 10px 13px;
      border-radius: 999px;
      border: 1px solid var(--border-subtle);
      background: rgba(15, 23, 42, 0.95);
      color: var(--text-main);
      font-size: 13px;
      outline: none;
      min-width: 0;
    }

    .url-input::placeholder {
      color: #6b7280;
    }

    .btn-primary {
      padding: 9px 16px;
      border-radius: 999px;
      border: none;
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      background: radial-gradient(circle at 0 0, #4ade80, #6366f1);
      color: #f9fafb;
      box-shadow: 0 14px 32px rgba(15, 23, 42, 0.9);
      display: inline-flex;
      align-items: center;
      gap: 6px;
      white-space: nowrap;
      transition:
        transform 0.16s ease,
        box-shadow 0.16s ease,
        filter 0.16s ease;
    }

    .btn-primary span {
      translate: 0 0;
      transition: translate 0.16s ease;
    }

    .btn-primary:hover {
      filter: brightness(1.05);
      transform: translateY(-1px);
      box-shadow: 0 20px 44px rgba(15, 23, 42, 0.95);
    }

    .btn-primary:hover span {
      translate: 0 -0.5px;
    }

    .btn-primary:active {
      transform: translateY(0);
      box-shadow: 0 9px 20px rgba(15, 23, 42, 0.95);
    }

    .btn-primary[disabled] {
      opacity: 0.7;
      cursor: default;
      box-shadow: none;
      transform: none;
    }

    /* STATUS / LOADING */
    .status-card {
      margin-top: 12px;
      background: linear-gradient(145deg, #020617, rgba(15, 23, 42, 0.98));
      border-radius: 18px;
      border: 1px solid rgba(148, 163, 184, 0.3);
      padding: 10px 12px 10px;
      display: none;
    }

    .status-header {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 8px;
      font-size: 13px;
      color: var(--text-muted);
    }

    .spinner {
      width: 16px;
      height: 16px;
      border-radius: 999px;
      border: 2px solid rgba(148, 163, 184, 0.4);
      border-top-color: var(--accent);
      animation: spin 0.7s linear infinite;
    }

    .status-steps {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 8px;
      font-size: 11px;
      margin-bottom: 2px;
    }

    .step {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 6px 8px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.96);
      border: 1px solid rgba(55, 65, 81, 0.7);
      color: var(--text-muted);
      white-space: nowrap;
    }

    .step-dot {
      width: 11px;
      height: 11px;
      border-radius: 999px;
      border: 2px solid rgba(148, 163, 184, 0.7);
    }

    .step-dot.active {
      border-color: var(--accent);
      background: var(--accent-soft);
    }

    .step-dot.done {
      border-color: var(--accent-strong);
      background: var(--accent-strong);
    }

    .step-check {
      font-size: 13px;
      color: var(--accent-strong);
      display: none;
    }

    .step.done .step-check {
      display: inline;
    }

    /* ERROR */
    .error-box {
      margin-top: 14px;
      padding: 10px 12px;
      border-radius: 14px;
      background: rgba(239, 68, 68, 0.12);
      border: 1px solid rgba(239, 68, 68, 0.45);
      color: #fecaca;
      font-size: 13px;
      display: none;
    }

    /* RESULTS */
    .results-card {
      margin-top: 20px;
      background: radial-gradient(circle at top left, rgba(99, 102, 241, 0.18), transparent 55%),
        radial-gradient(circle at bottom right, rgba(34, 197, 94, 0.18), transparent 55%),
        rgba(15, 23, 42, 0.98);
      border-radius: 24px;
      border: 1px solid rgba(148, 163, 184, 0.55);
      padding: 18px 16px 16px;
      display: none;
    }

    .results-header {
      display: flex;
      align-items: baseline;
      justify-content: space-between;
      gap: 12px;
      margin-bottom: 12px;
      flex-wrap: wrap;
    }

    .results-title {
      font-size: 14px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      color: var(--text-muted);
    }

    .results-sub {
      font-size: 12px;
      color: var(--text-muted);
    }

    .summary-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(230px, 1fr));
      gap: 14px;
      margin-top: 4px;
    }

    .summary-block {
      position: relative;
      padding: 10px 11px 11px;
      border-radius: 18px;
      background: linear-gradient(135deg, rgba(15, 23, 42, 0.96), #020617);
      border: 1px solid rgba(55, 65, 81, 0.8);
      font-size: 13px;
      overflow: hidden;
    }

    .summary-block::before {
      content: "";
      position: absolute;
      inset: -60%;
      background: radial-gradient(circle at 0 0, rgba(129, 140, 248, 0.2), transparent 60%);
      opacity: 0.55;
      mix-blend-mode: screen;
      pointer-events: none;
    }

    .summary-inner {
      position: relative;
      z-index: 1;
    }

    .summary-label-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      margin-bottom: 4px;
    }

    .summary-label {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: var(--text-muted);
    }

    .summary-icon {
      font-size: 14px;
      opacity: 0.85;
    }

    .summary-body {
      font-size: 13px;
      color: var(--text-main);
    }

    .score-row {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      margin-top: 14px;
    }

    .score-pill {
      padding: 8px 10px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.96);
      border: 1px solid rgba(55, 65, 81, 0.85);
      font-size: 12px;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .score-value {
      font-size: 18px;
      font-weight: 600;
      color: var(--accent-strong);
    }

    .mini-label {
      font-size: 11px;
      color: var(--text-muted);
    }

    .post-meta {
      margin-top: 12px;
      font-size: 12px;
      color: var(--text-muted);
    }

    .post-meta a {
      color: #93c5fd;
      text-decoration: none;
    }

    .post-meta a:hover {
      text-decoration: underline;
    }

    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }

    @keyframes bgShift {
      0% {
        background-position: 0% 0%;
      }
      50% {
        background-position: 100% 100%;
      }
      100% {
        background-position: 0% 0%;
      }
    }

    @keyframes floatCard {
      0%, 100% {
        transform: translateY(2px);
      }
      50% {
        transform: translateY(-4px);
      }
    }

    @keyframes pulseDot {
      0%, 100% {
        box-shadow: 0 0 0 4px rgba(34, 197, 94, 0.4);
      }
      50% {
        box-shadow: 0 0 0 8px rgba(34, 197, 94, 0.08);
      }
    }

    @media (max-width: 640px) {
      .form-card {
        flex-direction: column;
        align-items: stretch;
        border-radius: 22px;
      }
      .status-steps {
        grid-template-columns: 1fr;
      }
      .results-header {
        flex-direction: column;
        align-items: flex-start;
      }
    }
  </style>
</head>
<body>
  <div class="shell">
    <!-- HERO -->
    <div class="hero">
      <div class="hero-badge">
        <span class="hero-badge-dot"></span>
        REAL USER IDEA CHECK
      </div>
      <h1 class="hero-title">Validate your idea from real users</h1>
      <p class="hero-subtitle">
        Post your idea on Reddit or Twitter, then paste the URL here to get a clear, visual summary of what real users in the comments think about your product or startup idea.
      </p>
    </div>

    <!-- MAIN CARD -->
    <div class="app-card">
      <div class="app-inner">
        <!-- FORM -->
        <div class="form-label">Post URL</div>
        <form id="analyze-form" autocomplete="off">
          <div class="form-card">
            <input
              id="post-url-input"
              class="url-input"
              type="text"
              placeholder="Paste your Reddit or X/Twitter post URL here"
            />
            <button id="analyze-btn" class="btn-primary" type="submit">
              <span>‚ö° Start analysis</span>
            </button>
          </div>
        </form>

        <!-- STATUS / LOADING -->
        <div id="status-card" class="status-card">
          <div class="status-header">
            <div class="spinner" id="status-spinner"></div>
            <span id="status-text">Analyzing comments from real users‚Ä¶</span>
          </div>
          <div class="status-steps">
            <div class="step" id="step-fetch">
              <span class="step-dot" id="step-dot-fetch"></span>
              <span>Comments fetched</span>
              <span class="step-check">‚úì</span>
            </div>
            <div class="step" id="step-analyze">
              <span class="step-dot" id="step-dot-analyze"></span>
              <span>Analysis started</span>
              <span class="step-check">‚úì</span>
            </div>
            <div class="step" id="step-complete">
              <span class="step-dot" id="step-dot-complete"></span>
              <span>Analysis completed</span>
              <span class="step-check">‚úì</span>
            </div>
          </div>
        </div>

        <!-- ERROR -->
        <div id="error-box" class="error-box"></div>

        <!-- RESULTS -->
        <div id="results-card" class="results-card">
          <div class="results-header">
            <div class="results-title">What real users say about your idea</div>
            <div class="results-sub" id="results-subtext"></div>
          </div>

          <div class="summary-grid">
            <div class="summary-block">
              <div class="summary-inner">
                <div class="summary-label-row">
                  <div class="summary-label">Your idea</div>
                  <div class="summary-icon">üí°</div>
                </div>
                <div id="summary-idea" class="summary-body"></div>
              </div>
            </div>

            <div class="summary-block">
              <div class="summary-inner">
                <div class="summary-label-row">
                  <div class="summary-label">Solves this painful problem</div>
                  <div class="summary-icon">üî•</div>
                </div>
                <div id="summary-problem" class="summary-body"></div>
              </div>
            </div>

            <div class="summary-block">
              <div class="summary-inner">
                <div class="summary-label-row">
                  <div class="summary-label">Strengths users notice</div>
                  <div class="summary-icon">‚úÖ</div>
                </div>
                <div id="summary-strengths" class="summary-body"></div>
              </div>
            </div>

            <div class="summary-block">
              <div class="summary-inner">
                <div class="summary-label-row">
                  <div class="summary-label">What makes it unique</div>
                  <div class="summary-icon">‚ú®</div>
                </div>
                <div id="summary-unique" class="summary-body"></div>
              </div>
            </div>

            <div class="summary-block">
              <div class="summary-inner">
                <div class="summary-label-row">
                  <div class="summary-label">Recommendation</div>
                  <div class="summary-icon">üìä</div>
                </div>
                <div id="summary-recommended" class="summary-body"></div>
              </div>
            </div>

            <div class="summary-block">
              <div class="summary-inner">
                <div class="summary-label-row">
                  <div class="summary-label">Suggestions from the signal</div>
                  <div class="summary-icon">üõ†</div>
                </div>
                <div id="summary-suggestions" class="summary-body"></div>
              </div>
            </div>
          </div>

          <div class="score-row">
            <div class="score-pill">
              <div class="score-value" id="score-validation">‚Äì</div>
              <div>
                <div class="mini-label">How much people liked the idea</div>
              </div>
            </div>
            <div class="score-pill">
              <div class="score-value" id="score-problem-intensity">‚Äì</div>
              <div>
                <div class="mini-label">How strongly they feel this problem</div>
              </div>
            </div>
          </div>

          <div class="summary-block" style="margin-top: 14px;">
            <div class="summary-inner">
              <div class="summary-label-row">
                <div class="summary-label">What to add to make it a winning idea</div>
                <div class="summary-icon">üèÜ</div>
              </div>
              <div id="summary-winning" class="summary-body"></div>
            </div>
          </div>

          <div id="post-meta" class="post-meta"></div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const form = document.getElementById("analyze-form");
    const urlInput = document.getElementById("post-url-input");
    const analyzeBtn = document.getElementById("analyze-btn");

    const statusCard = document.getElementById("status-card");
    const statusText = document.getElementById("status-text");
    const statusSpinner = document.getElementById("status-spinner");

    const stepFetch = document.getElementById("step-fetch");
    const stepAnalyze = document.getElementById("step-analyze");
    const stepComplete = document.getElementById("step-complete");
    const dotFetch = document.getElementById("step-dot-fetch");
    const dotAnalyze = document.getElementById("step-dot-analyze");
    const dotComplete = document.getElementById("step-dot-complete");

    const errorBox = document.getElementById("error-box");
    const resultsCard = document.getElementById("results-card");
    const resultsSubtext = document.getElementById("results-subtext");

    const summaryIdea = document.getElementById("summary-idea");
    const summaryProblem = document.getElementById("summary-problem");
    const summaryStrengths = document.getElementById("summary-strengths");
    const summaryUnique = document.getElementById("summary-unique");
    const summaryRecommended = document.getElementById("summary-recommended");
    const summarySuggestions = document.getElementById("summary-suggestions");
    const scoreValidation = document.getElementById("score-validation");
    const scoreProblemIntensity = document.getElementById("score-problem-intensity");
    const summaryWinning = document.getElementById("summary-winning");
    const postMeta = document.getElementById("post-meta");

    function resetStatus() {
      statusCard.style.display = "none";
      errorBox.style.display = "none";
      resultsCard.style.display = "none";

      [stepFetch, stepAnalyze, stepComplete].forEach((step) => {
        step.classList.remove("done");
      });
      [dotFetch, dotAnalyze, dotComplete].forEach((dot) => {
        dot.classList.remove("active", "done");
      });
    }

    function startStatus() {
      statusCard.style.display = "block";
      statusText.textContent = "Analyzing comments from real users‚Ä¶";
      statusSpinner.style.display = "block";

      dotFetch.classList.add("active");
    }

    function markFetchDone() {
      stepFetch.classList.add("done");
      dotFetch.classList.remove("active");
      dotFetch.classList.add("done");
      dotAnalyze.classList.add("active");
    }

    function markAnalyzeDone() {
      stepAnalyze.classList.add("done");
      dotAnalyze.classList.remove("active");
      dotAnalyze.classList.add("done");
      dotComplete.classList.add("active");
    }

    function markComplete() {
      stepComplete.classList.add("done");
      dotComplete.classList.remove("active");
      dotComplete.classList.add("done");
      statusText.textContent = "Analysis completed.";
      statusSpinner.style.display = "none";
    }

    function showError(msg) {
      errorBox.textContent = msg || "Something went wrong.";
      errorBox.style.display = "block";
    }

    function formatList(list) {
      if (!list || !Array.isArray(list) || list.length === 0) return "No clear signals yet.";
      return "‚Ä¢ " + list.join("<br>‚Ä¢ ");
    }

    form.addEventListener("submit", async (e) => {
      e.preventDefault();

      const url = urlInput.value.trim();
      if (!url) {
        showError("Please enter a Reddit or X/Twitter post URL.");
        return;
      }

      resetStatus();
      startStatus();

      analyzeBtn.disabled = true;
      analyzeBtn.querySelector("span").textContent = "Analyzing‚Ä¶";

      try {
        markFetchDone();

        const resp = await fetch("/api/analyze", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({ post_url: url }),
        });

        if (!resp.ok) {
          const data = await resp.json().catch(() => ({}));
          throw new Error(data.error || "Server error while analyzing.");
        }

        const data = await resp.json();
        const results = data.results || {};
        const analysis = data.analysis || {};

        markAnalyzeDone();
        markComplete();

        summaryIdea.innerHTML = analysis.idea || "No summary available.";
        summaryProblem.innerHTML = analysis.problem_pain || "No clear problem extracted.";
        summaryStrengths.innerHTML = formatList(analysis.strengths);
        summaryUnique.innerHTML = analysis.your_differentiation || "No clear uniqueness identified.";
        summaryRecommended.innerHTML = analysis.summary || "No overall recommendation available.";
        summarySuggestions.innerHTML = analysis.advice || "No specific suggestions given.";

        scoreValidation.textContent =
          typeof analysis.validation_score === "number"
            ? `${analysis.validation_score}/100`
            : "‚Äì";

        const problemIntensity =
          typeof analysis.entry_barrier_score === "number"
            ? analysis.entry_barrier_score
            : typeof analysis.validation_score === "number"
              ? Math.round(analysis.validation_score * 0.9)
              : null;

        scoreProblemIntensity.textContent =
          typeof problemIntensity === "number" ? `${problemIntensity}/100` : "‚Äì";

        summaryWinning.innerHTML =
          analysis.your_differentiation && analysis.advice
            ? `${analysis.your_differentiation}<br><br>${analysis.advice}`
            : analysis.advice || "Double down on what users love and fix their biggest complaints.";

        const platform = results.platform || "";
        if (platform === "reddit") {
          resultsSubtext.textContent = "Based on comments from a Reddit thread.";
          postMeta.innerHTML = `
            From Reddit: <strong>${results.post_title || ""}</strong><br>
            <span>Subreddit: ${results.subreddit || ""}</span><br>
            <a href="${results.url || "#"}" target="_blank">Open original post</a>
          `;
        } else if (platform === "twitter") {
          resultsSubtext.textContent = "Based on comments from an X/Twitter post.";
          postMeta.innerHTML = `
            From X/Twitter: <strong>${results.author_name || ""}</strong> @${results.author_username || ""}<br>
            <a href="${results.url || "#"}" target="_blank">Open original post</a>
          `;
        } else {
          resultsSubtext.textContent = "";
          postMeta.innerHTML = results.url
            ? `<a href="${results.url}" target="_blank">Open original post</a>`
            : "";
        }

        resultsCard.style.display = "block";
      } catch (err) {
        console.error(err);
        showError(err.message);
        statusSpinner.style.display = "none";
        statusText.textContent = "Analysis failed.";
      } finally {
        analyzeBtn.disabled = false;
        analyzeBtn.querySelector("span").textContent = "‚ö° Start analysis";
      }
    });
  </script>
</body>
</html>